
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.3">
    
    
      
        <title>Python, Scraping, and Border Mapping - OARC Technology Sandbox</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/style.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#python-scraping-and-border-mapping" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="OARC Technology Sandbox" class="md-header__button md-logo" aria-label="OARC Technology Sandbox" data-md-component="logo">
      
  <img src="../../../logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OARC Technology Sandbox
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Python, Scraping, and Border Mapping
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../work/" class="md-tabs__link">
        
  
    
  
  Work

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../" class="md-tabs__link">
        
  
    
  
  Learn

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../connect/" class="md-tabs__link">
          
  
    
  
  Connect

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../musings/" class="md-tabs__link">
        
  
    
  
  Musings

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="OARC Technology Sandbox" class="md-nav__button md-logo" aria-label="OARC Technology Sandbox" data-md-component="logo">
      
  <img src="../../../logo.jpg" alt="logo">

    </a>
    OARC Technology Sandbox
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../work/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Work
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Learn
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
          
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../connect/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Connect
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Connect
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../connect/consult/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Consult
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../connect/where/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Where is the Sandbox?
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../musings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Musings
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#python-scraping-and-border-mapping" class="md-nav__link">
    <span class="md-ellipsis">
      Python, Scraping, and Border Mapping
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Python, Scraping, and Border Mapping">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#national-missing-and-unidentified-persons" class="md-nav__link">
    <span class="md-ellipsis">
      National Missing and Unidentified Persons
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web-scraping-with-python" class="md-nav__link">
    <span class="md-ellipsis">
      Web-scraping with Python
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Python, Scraping, and Border Mapping</h1>

<h2 id="python-scraping-and-border-mapping">Python, Scraping, and Border Mapping<a class="headerlink" href="#python-scraping-and-border-mapping" title="Permanent link">&para;</a></h2>
<p><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Mi&#47;MigrantDeaths\_15804327495940&#47;Dashboard1&#47;1\_rss.png' style='border: none' /></a></p>
<script type="text/javascript">var divElement = document.getElementById('viz1580509086766'); var vizElement = divElement.getElementsByTagName('object')[0]; if ( divElement.offsetWidth > 800 ) { vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.75)+'px';} else if ( divElement.offsetWidth > 500 ) { vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.75)+'px';} else { vizElement.style.width='100%';vizElement.style.height='877px';} var scriptElement = document.createElement('script'); scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js'; vizElement.parentNode.insertBefore(scriptElement, vizElement);</script>

<p><a class="glightbox" href="images/human-border-mapping-e1551810866736-1024x347.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="human-border-mapping" src="images/human-border-mapping-e1551810866736-1024x347.png" /></a></p>
<p>No data, no justice. As we try to imagine what border deaths <em>looks</em> like, we need information, data to enable our visual production. Borders can be defined in any number of ways. A drawn line produced by pen on paper, or a digitally enabled cartographic vector line can demarcate one side from another; a physical barrier, such as an impenetrable wall may symbolize a contested and divisive border. Cognitive borders, however, may not be as easily defined as a simple drawing of a line, or a construction of a massive barrier. As Sarah Mekdjian notes in her article on <em>Mapping Mobile Borders</em>, "Borders cannot be reduced to a linear and territorial conception."</p>
<p>How then do we go about mapping human borders? This article/tutorial is a practical approach that seeks to address this question through the experimental mapping of <em>border deaths</em> along the southern border of California and Mexico. It does so through the amalgamation of a suite of digital concepts and technologies, using <strong>Python</strong> for web-scraping border deaths, and various data visualization tools such as <strong>Palladio</strong> to inform us on the temporal and spatial implications of the humans who navigate and perish in the border lands.</p>
<h3 id="national-missing-and-unidentified-persons">National Missing and Unidentified Persons<a class="headerlink" href="#national-missing-and-unidentified-persons" title="Permanent link">&para;</a></h3>
<p><a href="https://www.namus.gov/"><img alt="" src="../images/namus-logo-tagline-2.png" /></a></p>
<p>More than 600,000 individuals go missing every year in the United States. It is also estimated that 4,400 unidentified bodies are recovered each year (source: https://www.namus.gov/About). Funded and administered by the National Institute of Justice, the NamUs website provides a searchable database for missing, unidentified, and missing persons.</p>
<p>With the objective to map border deaths, we look at the NamUs Unidentified Persons database. At the time of this writing, there are 12,559 results, 2,472 of which were found in California.</p>
<h3 id="web-scraping-with-python">Web-scraping with Python<a class="headerlink" href="#web-scraping-with-python" title="Permanent link">&para;</a></h3>
<p>Users can search NamUs using a myriad of data options: by demographic attributes like sex, race, estimated age, or by a more harrowing set of attributes such as by <em>details of recovery</em> that include options for: all parts recovered, head not recovered, torso not recovered, one or more limbs not recovered, or one or both hands not recovered. One can also search by <em>location found</em> which narrows our search results to only those recovered in California.</p>
<p>While the search interface provides an impressive array of options, the site does not provide a <em>download</em> option. With an impetus to match unidentified persons with their loved ones, downloading entire datasets has not been a priority for NamUs, despite their efforts for transparency and freedom of data access. The front-end interface provides a search result set as either a list of gallery view with a subset of the attributes for quick viewing purposes. Clicking on individual records then expands on any individual record to reveal its entire array of attributes.</p>
<p><a class="glightbox" href="../images/namus-dashboard.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Sample search results screenshot from NamUs" src="../images/namus-dashboard.png" /></a></p>
<p>Sample search results screenshot from NamUs</p>
<p>Peaking into the backend, the NamUs website is driven by a robust and well defined api to navigate, filter, and produce its search results. Python allows us to intercept, or configure these web requests using re-usable code. For example, the following script calls the NamUs API to get a summary list results for unidentified persons in California:</p>
<div class="highlight"><pre><span></span><code>import requests

# Set search parameters
state = &quot;California&quot;
records = &quot;10&quot;

# Search headers
headers = {
    &#39;Origin&#39;: &#39;https://www.namus.gov&#39;,
    &#39;Content-Type&#39;: &#39;application/json;charset=UTF-8&#39;,
    &#39;Referer&#39;: &#39;https://www.namus.gov/UnidentifiedPersons/Search&#39;,
    &#39;Connection&#39;: &#39;keep-alive&#39;,
}

# Request string
data = &#39;{&quot;predicates&quot;:[{&quot;field&quot;:&quot;stateOfRecovery&quot;,&quot;operator&quot;:&quot;IsIn&quot;,&quot;values&quot;:[&quot;California&quot;]}],&quot;take&quot;:2,&quot;skip&quot;:0,&quot;projections&quot;:[&quot;idFormatted&quot;,&quot;caseNumber&quot;,&quot;dateFound&quot;,&quot;estimatedAgeFrom&quot;,&quot;estimatedAgeTo&quot;,&quot;cityOfRecovery&quot;,&quot;countyDisplayNameOfRecovery&quot;,&quot;stateOfRecovery&quot;,&quot;sex&quot;,&quot;raceEthnicity&quot;,&quot;modifiedDateTime&quot;,&quot;namus2Number&quot;,&quot;stateDisplayNameOfRecovery&quot;],&quot;orderSpecifications&quot;:[{&quot;field&quot;:&quot;dateFound&quot;,&quot;direction&quot;:&quot;Descending&quot;}]}&#39;

# Send request
response = requests.post(&#39;https://www.namus.gov/api/CaseSets/NamUs/UnidentifiedPersons/Search&#39;, headers=headers, data=data)

print(response.content)
</code></pre></div>
<p>The above request produces the following results:</p>
<div class="highlight"><pre><span></span><code>{&quot;count&quot;:2472,&quot;results&quot;:[{&quot;idFormatted&quot;:&quot;UP55461&quot;,&quot;caseNumber&quot;:&quot;2019-01239&quot;,&quot;dateFound&quot;:&quot;2019-02-13T00:00:00&quot;,&quot;estimatedAgeFrom&quot;:null,&quot;estimatedAgeTo&quot;:null,&quot;cityOfRecovery&quot;:&quot;Llano&quot;,&quot;countyDisplayNameOfRecovery&quot;:&quot;Los Angeles&quot;,&quot;stateOfRecovery&quot;:&quot;California&quot;,&quot;sex&quot;:&quot;Unsure&quot;,&quot;raceEthnicity&quot;:&quot;Uncertain&quot;,&quot;modifiedDateTime&quot;:&quot;2019-02-26T15:54:19.94&quot;,&quot;namus2Number&quot;:55461,&quot;stateDisplayNameOfRecovery&quot;:&quot;CA&quot;,&quot;link&quot;:&quot;/UnidentifiedPersons/Case#/55461&quot;,&quot;image&quot;:&quot;/api/CaseSets/NamUs/UnidentifiedPersons/Cases/55461/Images/Default/Thumbnail&quot;},{&quot;idFormatted&quot;:&quot;UP55264&quot;,&quot;caseNumber&quot;:&quot;2019-00929&quot;,&quot;dateFound&quot;:&quot;2019-02-03T00:00:00&quot;,&quot;estimatedAgeFrom&quot;:40,&quot;estimatedAgeTo&quot;:60,&quot;cityOfRecovery&quot;:&quot;Los Angeles&quot;,&quot;countyDisplayNameOfRecovery&quot;:&quot;Los Angeles&quot;,&quot;stateOfRecovery&quot;:&quot;California&quot;,&quot;sex&quot;:&quot;Male&quot;,&quot;raceEthnicity&quot;:&quot;Hispanic / Latino&quot;,&quot;modifiedDateTime&quot;:&quot;2019-02-25T23:48:30.953&quot;,&quot;namus2Number&quot;:55264,&quot;stateDisplayNameOfRecovery&quot;:&quot;CA&quot;,&quot;link&quot;:&quot;/UnidentifiedPersons/Case#/55264&quot;,&quot;image&quot;:&quot;/api/CaseSets/NamUs/UnidentifiedPersons/Cases/55264/Images/Default/Thumbnail&quot;}]}
</code></pre></div>
<p>From this result set, we can determine that the ID for each individual record resides in the attribute <em>namus2Number</em>. With this in mind, we can safely presume to obtain all individual id numbers for unidentified people in California, and with this data, we can further obtain all the attributes for each individual record. The following python code loops through our results to do so:</p>
<div class="highlight"><pre><span></span><code>import json

# put the json response in a variable &quot;data&quot;
parsedSearchResponse = json.loads(response.content)
data = parsedSearchResponse[&#39;results&#39;]

# start a counter
count = 1

# let&#39;s print some preliminary results
print(&#39;Total records:&#39;)
print(len(data))

with open(&#39;jsondata7.json&#39;,&#39;w&#39;) as outfile:
    # json.dump(jsondata, outfile)
    jsondata = {}
    jsondata[&#39;people&#39;] = []

    # json.dump(&quot;{people: [&quot;,outfile)
    outfile.write(&#39;{&quot;people&quot;: [&#39;)

    records2process = len(data)

    for value in data:

        jsondata = {}
        jsondata[&#39;people&#39;] = []

        # get the id for this record and send a request for data
        id = value[&#39;namus2Number&#39;]
        # send the request to get the data for each person by id
        page = requests.get(&#39;https://www.namus.gov/api/CaseSets/NamUs/UnidentifiedPersons/Cases/&#39;+str(id))

        # put the response in a variable and decode to utf-8
        parsedPerson = json.loads(page.content.decode(&#39;utf-8&#39;))
        print(count)
        # output something to show
        # print(json.dumps(parsedPerson, indent=4, sort_keys=True))
        # jsondata[&#39;people&#39;].append(parsedPerson)

        json.dump(parsedPerson,outfile)
        # only write comma if not the last record
        if count &gt;= records2process:
            break
        else:
            outfile.write(&#39;,&#39;)
            count = count + 1


    outfile.write(&#39;]}&#39;)
</code></pre></div>
<p><a href="https://sandbox.idre.ucla.edu/sandbox/wp-content/uploads/2019/06/wordcloud-e1559754221287.png"><img alt="border death word cloud" src="images/wordcloud-e1559754221287-1024x768.png" /></a></p>
<p><a href="https://sandbox.idre.ucla.edu/sandbox/wp-content/uploads/2019/06/Screen-Shot-2019-06-05-at-10.39.33-AM-e1559756442360.png"><img alt="border death descriptions in palladio" src="images/Screen-Shot-2019-06-05-at-10.39.33-AM-e1559756442360-1024x694.png" /></a></p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.indexes"], "search": "../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
        <script src="../../../js/getdata.js"></script>
      
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>